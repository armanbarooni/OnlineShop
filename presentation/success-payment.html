<!doctype html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ÙˆÙÙ‚ÛŒØª Ù¾Ø±Ø¯Ø§Ø®Øª</title>
    <link rel="stylesheet" href="assets/css/app.css">
</head>
<body class="bg-light dark:bg-zinc-900 text-text-primary-light dark:text-text-primary-dark">
<main class="container py-10">
    <section class="max-w-2xl mx-auto bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-8 text-center">
        <h1 class="text-2xl font-bold text-green-600 mb-4">Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯</h1>
        <p id="statusText" class="text-gray-600 dark:text-gray-300 mb-6">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±Ø¯Ø§Ø®Øª...</p>
        <a id="ordersLink" href="user-panel-order.html" class="inline-flex items-center px-5 py-3 rounded-lg bg-primary text-white hover:bg-primary/90">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø³ÙØ§Ø±Ø´â€ŒÙ‡Ø§</a>
    </section>
</main>

<script src="assets/js/api-client.js"></script>
<script src="assets/js/services/payment-service.js"></script>
<script src="assets/js/utils.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', async () => {
        const url = new URL(window.location.href);
        const paymentId = url.searchParams.get('paymentId');
        const orderId = url.searchParams.get('orderId');
        const statusEl = document.getElementById('statusText');

        try {
            let result;
            if (paymentId) {
                result = await window.paymentService.getPaymentStatus(paymentId);
            } else if (orderId) {
                const res = await window.paymentService.getPaymentsByOrderId(orderId);
                if (res.success && Array.isArray(res.data) && res.data.length) {
                    result = await window.paymentService.getPaymentStatus(res.data[0].id || res.data[0].paymentId);
                } else {
                    statusEl.textContent = 'Ø³ÙØ§Ø±Ø´ ÛŒØ§ÙØª Ù†Ø´Ø¯ØŒ Ø§Ù…Ø§ Ù¾Ø±Ø¯Ø§Ø®Øª Ø«Ø¨Øª Ø´Ø¯.';
                    return;
                }
            }

            if (result && result.success) {
                statusEl.textContent = 'Ù¾Ø±Ø¯Ø§Ø®Øª ØªØ§ÛŒÛŒØ¯ Ø´Ø¯.';
            } else {
                statusEl.textContent = 'Ù¾Ø±Ø¯Ø§Ø®Øª Ø«Ø¨Øª Ø´Ø¯ØŒ ÙˆØ¶Ø¹ÛŒØª Ù†Ø§Ù…Ø´Ø®Øµ.';
            }
        } catch (e) {
            statusEl.textContent = 'Ø§Ù…Ú©Ø§Ù† Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±Ø¯Ø§Ø®Øª Ù†Ø¨ÙˆØ¯.';
        }
    });
</script>
</body>
</html>

